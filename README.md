# üåä ESP32 Water Quality Sensor

–ü—Ä–æ—à–∏–≤–∫–∞ –¥–ª—è ESP32 –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å pH –∏ ORP –¥–∞—Ç—á–∏–∫–∞–º–∏ —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π –≤ Home Assistant —á–µ—Ä–µ–∑ MQTT –∏ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.

## üìã –û –ø—Ä–æ–µ–∫—Ç–µ

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞—Ç—á–∏–∫–∞–º–∏:
- [Yieryi PH ORP Replacement Probe](https://aliexpress.ru/item/1005007574685909.html)
- [Liquid PH 0-14 Value Detection Regulator Sensor Module](https://aliexpress.ru/item/1005007574685909.html)
- [Liquid ORP Value Detection Regulator Sensor Module](https://aliexpress.ru/item/1005007574685909.html)

## üéõÔ∏è –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è –ø–ª–∞—Ç–∞ ESP32

–î–ª—è –ø—Ä–æ–µ–∫—Ç–∞ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–ª–∞—Ç—É [ESP32-WROOM-32](https://aliexpress.ru/item/1005005776600877.html) —Å–æ —Å–ª–µ–¥—É—é—â–∏–º–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º–∏:

- üéØ –ú–æ–¥–µ–ª—å: ESP32-WROOM-32
- üíæ Flash –ø–∞–º—è—Ç—å: 4MB
- üì∂ WiFi: 802.11 b/g/n
- üì° Bluetooth: 4.2 BR/EDR –∏ BLE
- üîã –ù–∞–ø—Ä—è–∂–µ–Ω–∏–µ –ø–∏—Ç–∞–Ω–∏—è: 3.3V
- üîå GPIO: 34 –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä—É–µ–º—ã—Ö –ø–∏–Ω–æ–≤
- ‚ö° –¢–æ–∫ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è: ~80mA –≤ –∞–∫—Ç–∏–≤–Ω–æ–º —Ä–µ–∂–∏–º–µ
- üìè –†–∞–∑–º–µ—Ä—ã: 25.5 x 18 –º–º

> üí° –ü–ª–∞—Ç–∞ ESP32-WROOM-32 —è–≤–ª—è–µ—Ç—Å—è –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–º –≤—ã–±–æ—Ä–æ–º –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ –±–ª–∞–≥–æ–¥–∞—Ä—è:
> - –°—Ç–∞–±–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç–µ —Å –∞–Ω–∞–ª–æ–≥–æ–≤—ã–º–∏ –≤—Ö–æ–¥–∞–º–∏
> - –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–º—É –∫–æ–ª–∏—á–µ—Å—Ç–≤—É GPIO –ø–∏–Ω–æ–≤
> - –í—Å—Ç—Ä–æ–µ–Ω–Ω–æ–π –∞–Ω—Ç–µ–Ω–Ω–µ WiFi
> - –•–æ—Ä–æ—à–µ–π –ø–æ–¥–¥–µ—Ä–∂–∫–µ –≤ Arduino IDE
> - –î–æ—Å—Ç—É–ø–Ω–æ–π —Ü–µ–Ω–µ

## üìä –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –¥–∞—Ç—á–∏–∫–æ–≤

### pH –î–∞—Ç—á–∏–∫
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –î–∏–∞–ø–∞–∑–æ–Ω |
|----------|----------|
| üß™ pH | 0-14 |
| üå°Ô∏è –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω–∞—è –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è | 0-60‚ÑÉ |
| ‚è±Ô∏è –í—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞ | ‚â§1s |
| üìè –¢–æ—á–Ω–æ—Å—Ç—å | ¬±0.1pH (25‚ÑÉ) |
| üîã –ù–∞–ø—Ä—è–∂–µ–Ω–∏–µ –ø–∏—Ç–∞–Ω–∏—è | 5V |
| üì° –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å | –ê–Ω–∞–ª–æ–≥–æ–≤—ã–π |
| üî¢ –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –ê–¶–ü | 12 –±–∏—Ç |

### ORP –î–∞—Ç—á–∏–∫
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –î–∏–∞–ø–∞–∑–æ–Ω |
|----------|----------|
| ‚ö° ORP | -2000 –¥–æ 2000 mV |
| üå°Ô∏è –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω–∞—è –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è | 0-60‚ÑÉ |
| ‚è±Ô∏è –í—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞ | ‚â§1s |
| üìè –¢–æ—á–Ω–æ—Å—Ç—å | ¬±5mV |
| üîã –ù–∞–ø—Ä—è–∂–µ–Ω–∏–µ –ø–∏—Ç–∞–Ω–∏—è | 5V |
| üì° –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å | –ê–Ω–∞–ª–æ–≥–æ–≤—ã–π |
| üî¢ –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –ê–¶–ü | 12 –±–∏—Ç |

## üîå –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

### ESP32 –∫ –º–æ–¥—É–ª—è–º –¥–∞—Ç—á–∏–∫–æ–≤
```
ESP32          –ú–æ–¥—É–ª—å pH –¥–∞—Ç—á–∏–∫–∞
5V    ------>  VCC
GND   ------>  GND
GPIO34 ------> PO (–∞–Ω–∞–ª–æ–≥–æ–≤—ã–π –≤—ã—Ö–æ–¥)

ESP32          –ú–æ–¥—É–ª—å ORP –¥–∞—Ç—á–∏–∫–∞
5V    ------>  VCC
GND   ------>  GND
GPIO35 ------> PO (–∞–Ω–∞–ª–æ–≥–æ–≤—ã–π –≤—ã—Ö–æ–¥)
```

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –¥–∞—Ç—á–∏–∫–æ–≤
```
–ú–æ–¥—É–ª—å pH –¥–∞—Ç—á–∏–∫–∞  pH –¥–∞—Ç—á–∏–∫
BNC —Ä–∞–∑—ä–µ–º <--- BNC —Ä–∞–∑—ä–µ–º

–ú–æ–¥—É–ª—å ORP –¥–∞—Ç—á–∏–∫–∞  ORP –¥–∞—Ç—á–∏–∫
BNC —Ä–∞–∑—ä–µ–º <--- BNC —Ä–∞–∑—ä–µ–º
```

## ‚öôÔ∏è –ù–∞—á–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

1. üîå –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –≤–∫–ª—é—á–µ–Ω–∏–∏ –¥–∞—Ç—á–∏–∫ —Å–æ–∑–¥–∞—Å—Ç —Ç–æ—á–∫—É –¥–æ—Å—Ç—É–ø–∞ WiFi:
   - üì∂ SSID: `WaterSensor`
   - üîë –ü–∞—Ä–æ–ª—å: `12345678`
   - üåê IP –∞–¥—Ä–µ—Å: `192.168.4.1`

2. üíª –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Ç–æ—á–∫–µ –¥–æ—Å—Ç—É–ø–∞ –∏ –æ—Ç–∫—Ä–æ–π—Ç–µ –≤–µ–±-–±—Ä–∞—É–∑–µ—Ä –ø–æ –∞–¥—Ä–µ—Å—É `http://192.168.4.1`

3. ‚öôÔ∏è –í –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã –¥–≤–µ –≤–∫–ª–∞–¥–∫–∏:

   ### üìä –í–∫–ª–∞–¥–∫–∞ "–ü–æ–∫–∞–∑–∞–Ω–∏—è"
   - –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Ç–µ–∫—É—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è pH –∏ ORP –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
   - –ü–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∫–∞–ª–∏–±—Ä–æ–≤–æ—á–Ω—ã–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–∞—Ç—á–∏–∫–∞:
     - –°–º–µ—â–µ–Ω–∏–µ (offset) - –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∫ –∏–∑–º–µ—Ä–µ–Ω–Ω–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é
     - –ú–Ω–æ–∂–∏—Ç–µ–ª—å (scale) - —É–º–Ω–æ–∂–∞–µ—Ç—Å—è –Ω–∞ –∏–∑–º–µ—Ä–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
   - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥
   - –ö–∞–ª–∏–±—Ä–æ–≤–æ—á–Ω—ã–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —ç–Ω–µ—Ä–≥–æ–Ω–µ–∑–∞–≤–∏—Å–∏–º–æ–π –ø–∞–º—è—Ç–∏

   ### ‚öôÔ∏è –í–∫–ª–∞–¥–∫–∞ "–ù–∞—Å—Ç—Ä–æ–π–∫–∞"
   - –ü–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:
     - üì∂ WiFi SSID –∏ –ø–∞—Ä–æ–ª—å
     - üì° –ê–¥—Ä–µ—Å MQTT —Å–µ—Ä–≤–µ—Ä–∞
     - üîë –õ–æ–≥–∏–Ω –∏ –ø–∞—Ä–æ–ª—å MQTT (–µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è)
   - –ü–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫ –¥–∞—Ç—á–∏–∫ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—Å—è –∏ –ø–æ–¥–∫–ª—é—á–∏—Ç—Å—è –∫ —É–∫–∞–∑–∞–Ω–Ω–æ–π WiFi —Å–µ—Ç–∏

## üíª –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ Arduino IDE

1. üìö –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:
   - PubSubClient
   - ArduinoJson
   - WiFi
   - WebServer
   - EEPROM

2. ‚ö° –ó–∞–≥—Ä—É–∑–∏—Ç–µ –ø—Ä–æ—à–∏–≤–∫—É –Ω–∞ ESP32

## üè† –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Home Assistant

–ü—Ä–æ—à–∏–≤–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ —Å–µ–Ω—Å–æ—Ä—ã –≤ Home Assistant:

- üß™ pH Value (–∑–Ω–∞—á–µ–Ω–∏–µ pH)
- ‚ö° ORP Value (–∑–Ω–∞—á–µ–Ω–∏–µ ORP –≤ mV)

> üí° –í—Å–µ —Å–µ–Ω—Å–æ—Ä—ã –±—É–¥—É—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã –≤ Home Assistant –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ ESP32 –∫ MQTT –±—Ä–æ–∫–µ—Ä—É.

## üì° MQTT –¢–æ–ø–∏–∫–∏

- ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è pH —Å–µ–Ω—Å–æ—Ä–∞: `homeassistant/sensor/ph_sensor/config`
- ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è ORP —Å–µ–Ω—Å–æ—Ä–∞: `homeassistant/sensor/orp_sensor/config`
- üìä –°–æ—Å—Ç–æ—è–Ω–∏–µ: `homeassistant/sensor/water_sensor/state`

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

- üìù –ü—Ä–æ—Ç–æ–∫–æ–ª: MQTT
- ‚ö° –°–∫–æ—Ä–æ—Å—Ç—å –ø–µ—Ä–µ–¥–∞—á–∏: 115200 –±–æ–¥
- üìä –§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö: JSON
- ‚è±Ô∏è –ò–Ω—Ç–µ—Ä–≤–∞–ª –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö: 5 —Å–µ–∫—É–Ω–¥

## ‚ö†Ô∏è –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- üîß –î–∞—Ç—á–∏–∫–∏ —Ç—Ä–µ–±—É—é—Ç –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏ –ø–µ—Ä–µ–¥ –ø–µ—Ä–≤—ã–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º
- üîã –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –ø–∏—Ç–∞–Ω–∏—è
- üå°Ô∏è –ü—Ä–∏ –¥–ª–∏—Ç–µ–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç–µ –≤ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–π —Å—Ä–µ–¥–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Ç–æ—á–Ω–æ—Å—Ç—å –∏–∑–º–µ—Ä–µ–Ω–∏–π
- üì° –î–ª—è —Ä–∞–±–æ—Ç—ã MQTT –Ω–µ–æ–±—Ö–æ–¥–∏–º MQTT –±—Ä–æ–∫–µ—Ä (–Ω–∞–ø—Ä–∏–º–µ—Ä, Mosquitto)
- üîí –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–∞—â–∏—â–µ–Ω–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ MQTT (TLS)
- üîÑ –î–ª—è —Å–±—Ä–æ—Å–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∫ –∑–∞–≤–æ–¥—Å–∫–∏–º, —É–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ –∫–Ω–æ–ø–∫—É BOOT –ø—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏ –ø–∏—Ç–∞–Ω–∏—è

## üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [üõí –î–∞—Ç—á–∏–∫ pH –Ω–∞ AliExpress](https://aliexpress.ru/item/1005007574685909.html)
- [üõí –ú–æ–¥—É–ª—å pH –Ω–∞ AliExpress](https://aliexpress.ru/item/1005007574685909.html)
- [üõí –ú–æ–¥—É–ª—å ORP –Ω–∞ AliExpress](https://aliexpress.ru/item/1005007574685909.html)
- [üõí ESP32 –Ω–∞ AliExpress](https://aliexpress.ru/item/1005005776600877.html)
- [üè† –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ MQTT Discovery –≤ Home Assistant](https://www.home-assistant.io/docs/mqtt/discovery/)
- [üõ†Ô∏è –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ](SETUP.md) 