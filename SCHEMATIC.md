# 📡 Принципиальная схема подключения

## 🔌 Общее описание

Схема представляет собой подключение pH и ORP датчиков к ESP32 через аналоговые входы. Система обеспечивает:
- 📶 Беспроводную передачу данных через WiFi
- 📊 Аналоговое считывание значений с датчиков
- 🔋 Питание от USB или внешнего источника
- 🔦 Визуальную индикацию работы
- 🔘 Возможность программирования и сброса

## 🎛️ Основные компоненты

1. ESP32-WROOM-32
   - Микроконтроллер с WiFi
   - Рабочее напряжение: 3.3V
   - Тактовая частота: 240MHz
   - Flash память: 4MB
   - АЦП: 12 бит

2. Модуль pH датчика
   - Рабочее напряжение: 5V
   - Выходной сигнал: 0-5V
   - Интерфейс: BNC
   - Точность: ±0.1pH

3. Модуль ORP датчика
   - Рабочее напряжение: 5V
   - Выходной сигнал: 0-5V
   - Интерфейс: BNC
   - Точность: ±5mV

## 🔋 Схема питания

### Вариант 1: Питание от USB
```
USB 5V ──────┬────── ESP32 5V
             │
             ├────── Модуль pH VCC
             │
             └────── Модуль ORP VCC
                    │
                    ├── 100nF ─── GND
                    │
                    └── 100nF ─── GND
```

### Вариант 2: Питание от AC-DC преобразователя 220V to 5V

```
220V AC ─── AC-DC преобразователь ─── 5V DC ──────┬────── ESP32 5V
                                                  │
                                                  ├────── Модуль pH VCC
                                                  │
                                                  └────── Модуль ORP VCC
                                                         │
                                                         ├── 100nF ─── GND
                                                         │
                                                         ├── 1000uF ─── GND
                                                         │
                                                         └── 100nF ─── GND
```

#### 🔌 Рекомендуемый AC-DC преобразователь:
- Входное напряжение: 100-240V AC
- Выходное напряжение: 5V DC
- Выходной ток: не менее 1A
- КПД: не менее 80%
- Защита от короткого замыкания
- Защита от перегрузки
- Изоляция вход/выход: 3000V AC

#### ⚡ Особенности подключения:
1. 🔒 Безопасность
   - Использовать только сертифицированные преобразователи
   - Обеспечить надежное заземление
   - Защитить от попадания влаги
   - Использовать корпус с классом защиты IP65 или выше

2. 🔋 Фильтрация питания
   - Конденсатор 1000uF для сглаживания пульсаций
   - Конденсаторы 100nF для фильтрации ВЧ помех
   - Размещение конденсаторов максимально близко к потребителям

3. 📏 Монтаж
   - Минимальная длина проводов питания
   - Сечение проводов не менее 0.5mm²
   - Надежная изоляция всех соединений
   - Защита от механических повреждений

4. ⚠️ Меры предосторожности
   - Не подключать к сети 220V при открытом корпусе
   - Проверять изоляцию перед включением
   - Использовать предохранитель на входе
   - Обеспечить вентиляцию преобразователя

## 🔌 Подключение ESP32 к модулям датчиков

```
ESP32          Модуль pH датчика
GPIO34 (ADC1) ─── PO (аналоговый выход)
5V     ─────── VCC
GND    ─────── GND

ESP32          Модуль ORP датчика
GPIO35 (ADC1) ─── PO (аналоговый выход)
5V     ─────── VCC
GND    ─────── GND
```

## 🔌 Подключение датчиков к модулям

```
Модуль pH датчика  pH датчик
BNC разъем <--- BNC разъем

Модуль ORP датчика  ORP датчик
BNC разъем <--- BNC разъем
```

## 💡 Дополнительные компоненты

### Индикация работы
```
GPIO2 ─── 220Ω ─── LED ─── GND
```

### Кнопки управления
```
GPIO0 ─── Кнопка ─── GND
GPIO15 ── Кнопка ─── GND
```

### USB-UART
```
ESP32          USB-UART
GPIO3 (U0RXD) ─── TX
GPIO1 (U0TXD) ─── RX
EN            ─── RST
GPIO0         ─── DTR
```

## ⚡ Особенности схемы

1. 📊 Аналоговые входы
   - Использование ADC1 (GPIO34, GPIO35)
   - Разрешение АЦП: 12 бит
   - Внутреннее усиление: 11dB

2. ⚡ Фильтрация питания
   - Конденсаторы 100nF на всех источниках питания
   - Стабилизация напряжения 5V

3. 🔦 Индикация
   - Светодиод на GPIO2
   - Резистор 220 Ом для ограничения тока

4. 🔘 Управление
   - Кнопка на GPIO0 для программирования
   - Кнопка на GPIO15 для сброса

## 📝 Примечания

1. ⚠️ Безопасность
   - Использовать стабилизированный источник питания
   - Соблюдать полярность подключения
   - Проверять напряжение перед подключением

2. 🔧 Настройка
   - Калибровка pH датчика: pH 4.01, 7.00, 10.01
   - Калибровка ORP датчика: 256mV ([калибровочный раствор](https://aliexpress.ru/item/1005005530457843.html?sku_id=12000033431556016&spm=a2g2w.productlist.search_results.0.4a1e68f018nF5z))
   - Сохранение калибровочных коэффициентов в EEPROM

3. 🛠️ Отладка
   - Мониторинг через Serial (115200 бод)
   - Индикация светодиодом
   - Возможность сброса

## 🔍 Рекомендации по монтажу

1. 📏 Размещение компонентов
   - ESP32 и модули датчиков рядом
   - Короткие аналоговые соединения
   - Изоляция аналоговых и цифровых цепей

2. 🔌 Пайка
   - Использовать припой с флюсом
   - Контролировать температуру
   - Избегать перегрева компонентов

3. 📡 Антенна WiFi
   - Не размещать металлические предметы рядом
   - Обеспечить свободное пространство
   - Учесть влияние корпуса

## ⚠️ Возможные проблемы

1. 🔴 Нет показаний с датчиков
   - Проверить питание модулей
   - Проверить подключение аналоговых входов
   - Проверить калибровку

2. 🔴 Нестабильные показания
   - Проверить конденсаторы
   - Проверить заземление
   - Проверить длину аналоговых линий

3. 🔴 Проблемы с WiFi
   - Проверить антенну
   - Проверить настройки
   - Проверить помехи 